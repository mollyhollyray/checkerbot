const { sendMessage } = require('../utils/message');
const { log } = require('../utils/logger');

const COMMAND_HELP = {
  main: `
üå∏ *GitHub Tracker Bot* üå∏

üìå *–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üîπ /add      - –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ  üîπ /remove   - –£–¥–∞–ª–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ  üîπ /list     - –°–ø–∏—Å–æ–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö
‚îÇ  üîπ /branches - –ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ç–∫–∏
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üìú *–†–∞–±–æ—Ç–∞ —Å –∫–æ–º–º–∏—Ç–∞–º–∏:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üåø /last - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üîÑ *Pull Requests:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üîÑ /pr     - –°–ø–∏—Å–æ–∫ PR
‚îÇ  üîç /prview - –î–µ—Ç–∞–ª–∏ PR
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

‚öôÔ∏è *–°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üìä /limits - –õ–∏–º–∏—Ç—ã API
‚îÇ  ‚ùì /help   - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üí° *–î–ª—è –¥–µ—Ç–∞–ª–µ–π:* \`/help [–∫–æ–º–∞–Ω–¥–∞]\`
–ü—Ä–∏–º–µ—Ä: \`/help add\`
  `,

  add: `
‚ú® *–ö–æ–º–∞–Ω–¥–∞ /add* ‚ú®

‚ñ´Ô∏è *–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:*
\`\`\`
/add –≤–ª–∞–¥–µ–ª–µ—Ü/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
\`\`\`

*–ü—Ä–∏–º–µ—Ä:*
\`\`\`
/add facebook/react
\`\`\`

üìã *–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:*
‚Ä¢ –î–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
‚Ä¢ –ù–∞—á–∏–Ω–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–≤—ã—Ö –∫–æ–º–º–∏—Ç–æ–≤
‚Ä¢ –ü—Ä–∏—Å—ã–ª–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

‚ö†Ô∏è *–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:*
‚Ä¢ –¢–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚Ä¢ –ú–∞–∫—Å. 100 —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
‚Ä¢ –õ–∏–º–∏—Ç—ã GitHub API
  `,

  remove: `
üóë *–ö–æ–º–∞–Ω–¥–∞ /remove* üóë

‚ñ´Ô∏è *–°–∏–Ω—Ç–∞–∫—Å–∏—Å:*
\`\`\`
/remove –≤–ª–∞–¥–µ–ª–µ—Ü/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
\`\`\`

*–ü—Ä–∏–º–µ—Ä:*
\`\`\`
/remove vuejs/core
\`\`\`

üìã *–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:*
‚Ä¢ –£–¥–∞–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
‚Ä¢ –ü—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚Ä¢ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤

üîÑ *–ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:*
–ü—Ä–æ—Å—Ç–æ —Å–Ω–æ–≤–∞ –¥–æ–±–∞–≤—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫–æ–º–∞–Ω–¥–æ–π /add
  `,

  list: `
üìã *–ö–æ–º–∞–Ω–¥–∞ /list* üìã

‚ñ´Ô∏è *–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:*
\`\`\`
/list
\`\`\`

*–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:*
\`\`\`
üåê facebook
  ‚îî‚îÄ üîπ react (main)
     üìÖ 15.05.2023
     üÜî a1b2c3d
\`\`\`

üìå *–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:*
‚Ä¢ –í—Å–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚Ä¢ –í–µ—Ç–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
‚Ä¢ –•–µ—à –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞
‚Ä¢ –î–∞—Ç—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

üîç *–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:*
‚Ä¢ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º
‚Ä¢ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
  `,

  branches: `
üåø *–ö–æ–º–∞–Ω–¥–∞ /branches* üåø

‚ñ´Ô∏è *–§–æ—Ä–º–∞—Ç:*
\`\`\`
/branches –≤–ª–∞–¥–µ–ª–µ—Ü/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
\`\`\`

*–ü—Ä–∏–º–µ—Ä:*
\`\`\`
/branches axios/axios
\`\`\`

üå≥ *–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:*
‚Ä¢ –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–µ—Ç–∫–∏
‚Ä¢ –ê–ª—Ñ–∞–≤–∏—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
‚Ä¢ –î–æ 50 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

‚ö° *–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:*
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub API
‚Ä¢ –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ 5 –º–∏–Ω—É—Ç
‚Ä¢ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏
  `,

  pr: `
üîÑ *–ö–æ–º–∞–Ω–¥–∞ /pr* üîÑ

‚ñ´Ô∏è *–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:*
\`\`\`
/pr –≤–ª–∞–¥–µ–ª–µ—Ü/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π [—Å–æ—Å—Ç–æ—è–Ω–∏–µ] [–ª–∏–º–∏—Ç]
\`\`\`

*–ü—Ä–∏–º–µ—Ä—ã:*
\`\`\`
/pr reactjs/react
/pr vuejs/core closed 10
/pr webpack/webpack all label:bug
\`\`\`

üîß *–§–∏–ª—å—Ç—Ä—ã:*
‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ: \`open\` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), \`closed\`, \`all\`
‚Ä¢ –ú–µ—Ç–∫–∏: \`label:–Ω–∞–∑–≤–∞–Ω–∏–µ\`
‚Ä¢ –õ–∏–º–∏—Ç: 1-20 (5 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

üìä *–í—ã–≤–æ–¥:*
‚Ä¢ –ù–æ–º–µ—Ä –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ PR
‚Ä¢ –ê–≤—Ç–æ—Ä
‚Ä¢ –°—Ç–∞—Ç—É—Å
‚Ä¢ –ú–µ—Ç–∫–∏
  `,

  prview: `
üîç *–ö–æ–º–∞–Ω–¥–∞ /prview* üîç

‚ñ´Ô∏è *–°–∏–Ω—Ç–∞–∫—Å–∏—Å:*
\`\`\`
/prview –≤–ª–∞–¥–µ–ª–µ—Ü/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–æ–º–µ—Ä_PR
\`\`\`

*–ü—Ä–∏–º–µ—Ä:*
\`\`\`
/prview webpack/webpack 14258
\`\`\`

üìú *–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:*
‚Ä¢ –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ PR
‚Ä¢ –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
‚Ä¢ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏

üîó *–°—Å—ã–ª–∫–∏:*
‚Ä¢ –ù–∞ GitHub
‚Ä¢ –ù–∞ diff –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚Ä¢ –ù–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
  `,

  limits: `
‚öñÔ∏è *–ö–æ–º–∞–Ω–¥–∞ /limits* ‚öñÔ∏è

‚ñ´Ô∏è *–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:*
\`\`\`
/limits
\`\`\`

*–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:*
\`\`\`
üìä –õ–∏–º–∏—Ç—ã GitHub API:
üü¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: 42/5000
üïí –°–±—Ä–æ—Å —á–µ—Ä–µ–∑: 18 –º–∏–Ω—É—Ç
\`\`\`

‚ÑπÔ∏è *–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:*
‚Ä¢ –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API
‚Ä¢ –û—Å—Ç–∞–≤—à–∏–π—Å—è –ª–∏–º–∏—Ç
‚Ä¢ –í—Ä–µ–º—è –¥–æ —Å–±—Ä–æ—Å–∞ —Å—á–µ—Ç—á–∏–∫–∞

‚ö†Ô∏è *–í–∞–∂–Ω–æ:*
‚Ä¢ –õ–∏–º–∏—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å
‚Ä¢ –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ - –≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
  `
};

module.exports = async (ctx) => {
  const [_, command] = ctx.message.text.split(' ');
  
  try {
    const helpText = command 
      ? COMMAND_HELP[command.toLowerCase()] || COMMAND_HELP.main
      : COMMAND_HELP.main;
    
    await sendMessage(ctx, helpText, { 
      parse_mode: 'MarkdownV2',
      disable_web_page_preview: true
    });
    
    log(`Help delivered for: ${command || 'main'}`);
  } catch (error) {
    logError(error, 'Help command failed');
    await sendMessage(ctx, 
      '‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ —Å–ø—Ä–∞–≤–∫–∏\n' +
      '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å',
      { parse_mode: 'MarkdownV2' }
    );
  }
};