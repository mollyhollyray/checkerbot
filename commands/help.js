const { sendMessage } = require('../utils/message');
const { log } = require('../utils/logger');

const COMMAND_HELP = {
  main: `üå∏ *GitHub Tracker Bot* üå∏ *Help Center*

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìö *–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üîπ /add - –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ  üîπ /remove - –£–¥–∞–ª–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ  üîπ /list - –°–ø–∏—Å–æ–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö
‚îÇ  üîπ /check - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üåø *–†–∞–±–æ—Ç–∞ —Å –≤–µ—Ç–∫–∞–º–∏:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üåø /branches - –ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ç–∫–∏
‚îÇ  üåø /last - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üîÑ *Pull Requests:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üîÑ /pr - –°–ø–∏—Å–æ–∫ PR
‚îÇ  üîç /prview - –î–µ—Ç–∞–ª–∏ PR
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

‚öôÔ∏è *–°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ  üìä /limits - –õ–∏–º–∏—Ç—ã API
‚îÇ  ‚ùì /help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üí° *–î–ª—è –¥–µ—Ç–∞–ª–µ–π –ø–æ –∫–æ–º–∞–Ω–¥–µ:* \`/help [–∫–æ–º–∞–Ω–¥–∞]\`
–ü—Ä–∏–º–µ—Ä: \`/help add\``,

  add: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /add* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–î–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

üìå *–§–æ—Ä–º–∞—Ç:*
\`/add owner/repo\`

üìå *–ü—Ä–∏–º–µ—Ä—ã:*
\`/add facebook/react\`
\`/add axios/axios main\`

üìå *–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:*
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–µ—Ç–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚Ä¢ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç`,

  remove: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /remove* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–£–¥–∞–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

üìå *–§–æ—Ä–º–∞—Ç:*
\`/remove owner/repo\`

üìå *–ü—Ä–∏–º–µ—Ä:*
\`/remove facebook/react\`

‚ö†Ô∏è *–¢—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è*`,

  list: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /list* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

üìå *–§–æ—Ä–º–∞—Ç:*
\`/list\`

üìå *–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:*
‚Ä¢ –í–µ—Ç–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç
‚Ä¢ –î–∞—Ç—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
‚Ä¢ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å`,

  branches: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /branches* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ç–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

üìå *–§–æ—Ä–º–∞—Ç:*
\`/branches owner/repo [limit]\`

üìå *–ü—Ä–∏–º–µ—Ä—ã:*
\`/branches facebook/react\`
\`/branches vuejs/core 25\`

üìå *–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:*
‚Ä¢ –í–µ—Ç–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (üëë)
‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç
‚Ä¢ –î–∞—Ç—É –∏–∑–º–µ–Ω–µ–Ω–∏—è
‚Ä¢ –°—Å—ã–ª–∫—É –Ω–∞ –∫–æ–º–º–∏—Ç`,

  last: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /last* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã

üìå *–§–æ—Ä–º–∞—Ç:*
\`/last owner/repo [branch] [count]\`

üìå *–ü—Ä–∏–º–µ—Ä—ã:*
\`/last facebook/react\`
\`/last vuejs/core next 5\`

üìå *–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:*
‚Ä¢ –•–µ—à –∫–æ–º–º–∏—Ç–∞
‚Ä¢ –ê–≤—Ç–æ—Ä–∞
‚Ä¢ –î–∞—Ç—É
‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏–µ
‚Ä¢ –°—Å—ã–ª–∫—É`,

  pr: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /pr* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç Pull Requests

üìå *–§–æ—Ä–º–∞—Ç:*
\`/pr owner/repo [state] [limit] [filters]\`

üìå *–ü—Ä–∏–º–µ—Ä—ã:*
\`/pr facebook/react\`
\`/pr vuejs/core closed 10\`
\`/pr webpack/webpack label:bug\`

üìå *–§–∏–ª—å—Ç—Ä—ã:*
‚Ä¢ state: open|closed|all
‚Ä¢ label:–º–µ—Ç–∫–∞
‚Ä¢ author:–∞–≤—Ç–æ—Ä`,

  prview: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /prview* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ PR

üìå *–§–æ—Ä–º–∞—Ç:*
\`/prview owner/repo pr_number\`

üìå *–ü—Ä–∏–º–µ—Ä:*
\`/prview facebook/react 123\`

üìå *–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:*
‚Ä¢ –°—Ç–∞—Ç—É—Å PR
‚Ä¢ –ê–≤—Ç–æ—Ä–∞
‚Ä¢ –í–µ—Ç–∫–∏
‚Ä¢ –ú–µ—Ç–∫–∏
‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∏ CI
‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ`,

  limits: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /limits* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏–º–∏—Ç—ã GitHub API

üìå *–§–æ—Ä–º–∞—Ç:*
\`/limits\`

üìå *–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:*
‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
‚Ä¢ –û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–ø—Ä–æ—Å—ã
‚Ä¢ –í—Ä–µ–º—è –¥–æ —Å–±—Ä–æ—Å–∞`,

  check: `‚ú® *–ö–æ–º–∞–Ω–¥–∞ /check* ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

üìå *–§–æ—Ä–º–∞—Ç:*
\`/check\`

üìå *–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:*
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚Ä¢ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –∫–æ–º–º–∏—Ç—ã
‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –∞–≤—Ç–æ-–ø—Ä–æ–≤–µ—Ä–∫–æ–π`
};

module.exports = async (ctx) => {
  const [_, command] = ctx.message.text.split(' ')
  
  try {
    const helpText = command 
      ? COMMAND_HELP[command.toLowerCase()] || COMMAND_HELP.main
      : COMMAND_HELP.main;

const buttons = [
  [
    { 
      text: "üìã –°–ø–∏—Å–æ–∫", 
      callback_data: "help_list" 
    },
    { 
      text: "üîÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å", 
      callback_data: "help_check" 
    }
  ],
  [
  { 
    text: "üåø –í–µ—Ç–∫–∏", 
    callback_data: "help_branches" 
  },
    { 
      text: "üîÑ PR", 
      callback_data: "help_pr" 
    }
  ]
];

    await sendMessage(ctx, helpText, { 
      parse_mode: 'MarkdownV2',
      disable_web_page_preview: true,
      reply_markup: {
        inline_keyboard: buttons
      }
    });
    
    log(`Help delivered for: ${command || 'main'}`);
  } catch (error) {
    logError(error, 'Help command failed');
    await sendMessage(ctx, 
      '‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ —Å–ø—Ä–∞–≤–∫–∏\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑',
      { parse_mode: 'MarkdownV2' }
    );
  }
};